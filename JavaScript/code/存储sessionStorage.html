<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sessionStorage</title>
  </head>
  <body>
    <h3>新增或修改</h3>
    <div>key: <input type="text" id="key" /></div>
    <div>value: <input type="text" id="value" /></div>
    <button onclick="add()">添加数据</button>
    <h3>删除或清空</h3>
    <div>key: <input type="text" id="key1" /></div>
    <div>全部清空：<input type="radio" id="isAll" name="s" />是<input type="radio" name="s" checked="true" />否</div>
    <button onclick="remove()">删除存储</button>
    <h3>查看指定的item</h3>
    <div>key：<input type="text" id="key2" /></div>
    <button onclick="get()">查看</button>
    <h3>通过索引获取key</h3>
    <div>index：<input type="number" id="key3" /></div>
    <button onclick="getByIndex()">通过索引获取key</button>
    <h3>获取存储记录条数</h3>
    <button onclick="getLength()">记录条数</button>
    <h3>在新标签或窗口打开页面</h3>
    <a href="./存储localStorage.html" target="_black">新窗口打开同源页</a>
    <a href="http://127.0.0.1:8848/FE-Review/JavaScript/code/%E5%AD%98%E5%82%A8sessionStorage.html" target="_black">新窗口打开非同源页</a>
    <a href="./存储localStorage.html" target="_self">本窗口打开同源页面</a>
    <a href="http://127.0.0.1:8848/FE-Review/JavaScript/code/%E5%AD%98%E5%82%A8sessionStorage.html" target="_self">本窗口打开非同源页面</a>
    <script>
      // 监听storage事件
      window.addEventListener('storage',function(event){
        console.log("发生变动的key:",event.key);
        console.log("旧值:",event.oldValue);
        console.log("新值:",event.newValue);
        console.log("触发事件页面的url:",event.url);
        console.log("localStorage数据对象:",event.storageArea);
      })
      function add() {
        var key = document.getElementById("key").value;
        var val = document.getElementById("value").value;
        console.log(val);
        sessionStorage.setItem(key, val);
      }
      function remove() {
        var key1 = document.querySelector("#key1").value;
        var isAll = document.querySelector("#isAll").checked;
        if (isAll) {
          sessionStorage.clear();
        } else {
          if (key1) {
            sessionStorage.removeItem(key1);
          } else {
            alert("属性名不能为空");
          }
        }
      }
      function get() {
        var key2 = document.getElementById("key2").value;
        var res = sessionStorage.getItem(key2);
        alert(res);
      }
      function getByIndex() {
        var key3 = document.getElementById("key3").value;
        var res = sessionStorage.key(Number(key3));
        alert(res);
      }
      function getLength(){
        var len = sessionStorage.length;
        alert(len)
      }
    </script>
  </body>
</html>
